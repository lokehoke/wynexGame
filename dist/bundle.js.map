{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./resources/js/modules/globalClass/game.js","webpack:///./resources/js/modules/globalClass/state/inerState/events/StorCustomEvents.js","webpack:///./resources/js/modules/globalClass/state/inerState/place/blocks/block.js","webpack:///./resources/js/modules/globalClass/state/inerState/place/blocks/borderblock.js","webpack:///./resources/js/modules/globalClass/state/inerState/place/blocks/controllerBlock.js","webpack:///./resources/js/modules/globalClass/state/inerState/place/blocks/dirtblock.js","webpack:///./resources/js/modules/globalClass/state/inerState/place/place.js","webpack:///./resources/js/modules/globalClass/state/inerState/stackTemp/stackTempClassName.js","webpack:///./resources/js/modules/globalClass/state/state.js","webpack:///./resources/js/modules/globalClass/world.js","webpack:///./resources/js/modules/index.js","webpack:///./resources/js/modules/inerObjects/creature.js","webpack:///./resources/js/modules/inerObjects/enemy.js","webpack:///./resources/js/modules/inerObjects/innerObject.js","webpack:///./resources/js/modules/inerObjects/player.js","webpack:///./resources/js/modules/inerObjects/weapon.js","webpack:///./resources/js/modules/setting/globalSetting.js","webpack:///./resources/js/modules/structOfDate/ExCoordinate.js","webpack:///./resources/js/modules/structOfDate/coordinate.js","webpack:///./resources/js/modules/structOfDate/size.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACjIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,C;;;;;;;;;;;;ACdA;;AAEA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACPA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACZA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACfA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;ACZA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,OAAO;AACxB;AACA,kBAAkB,OAAO;AACzB;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,iBAAiB,OAAO;AACxB,kBAAkB,OAAO;AACzB;AACA;AACA,oBAAoB,0BAA0B;AAC9C;AACA,sBAAsB,4BAA4B;AAClD;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,C;;;;;;;;;;;;ACjEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA,C;;;;;;;;;;;;ACdA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,C;;;;;;;;;;;;AChPA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,kBAAkB,2BAA2B;AAC7C;AACA;AACA,mBAAmB,0BAA0B;AAC7C,wCAAwC,cAAc;AACtD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,mBAAmB,2BAA2B;;AAE9C;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,oCAAoC,cAAc;;AAElD;AACA;AACA,MAAM;AACN;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA,mBAAmB,0BAA0B;AAC7C;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA,wCAAwC,cAAc;;AAEtD;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,C;;;;;;;;;;;;ACxTA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;;;AAGA,Y;;;;;;;;;;;;AC1DA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;AACJ;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;;AAEA,kBAAkB,UAAU;AAC5B;;AAEA,mBAAmB,UAAU;AAC7B;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,mBAAmB,UAAU;AAC7B;AACA;AACA;;AAEA,oBAAoB,UAAU;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;;AAEJ;AACA,qBAAqB,QAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,C;;;;;;;;;;;;ACvTA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACXA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wCAAwC,2BAA2B;;AAEnE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,uCAAuC,6BAA6B;AACpE;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,uCAAuC,6BAA6B;AACpE;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,uCAAuC,6BAA6B;AACpE;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,uCAAuC,6BAA6B;AACpE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA,kCAAkC,yBAAyB;AAC3D;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACvMA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;AC1BA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;AChCA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,C;;;;;;;;;;;;ACdA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACVA;;AAEA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACPA;;AAEA;AACA;AACA;AACA;AACA;AACA,C","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./resources/js/modules/index.js\");\n","'use strict';\r\n\r\nconst State = require('./state/state.js');\r\nconst World = require('./world.js');\r\nconst GLOBAL_SETTING_CLASS = require('../setting/globalSetting.js');\r\nconst GLOBAL_SETTING = new GLOBAL_SETTING_CLASS();\r\n\r\nmodule.exports = class ControllerGame {\r\n\tconstructor (players = null, enemy = []) {\r\n\t\tthis.state = new State(GLOBAL_SETTING.numBlocks);\r\n\t\tthis._setPlayers(players, this.state);\r\n\r\n\t\tthis._definedAndSetStartPointWatch(players);\r\n\r\n\t\tenemy = enemy.concat(World.makeAroayWihtEnemy(GLOBAL_SETTING.numEnemy, this.state));\r\n\t\tthis._setEnemys(enemy, this.state);\r\n\r\n\t\tthis.world = new World(this.state);\r\n\t\tconst worldDiv = this.world.renderWorld(true);\r\n\r\n\t\tthis.state.setWorldDiv(worldDiv);\r\n\t\tthis.state.setWorldObject(this.world);\r\n\t}\r\n\r\n\t_definedAndSetStartPointWatch(players) {\r\n\t\tconst startPoint = this._getStartPiointWatch(players, this.state);\r\n\r\n\t\tif (startPoint === false) {\r\n\t\t\tthrow \"2 or more main player or null\";\r\n\t\t} else {\r\n\t\t\tthis.state.setStartPointWatch(startPoint);\r\n\t\t}\r\n\t}\r\n\r\n\t_setPlayers(players, state) {\r\n\t\tif (players !== null) {\r\n\t\t\tplayers.forEach((val) => {\r\n\t\t\t\tstate.setPlayer(val);\r\n\t\t\t});\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t_setEnemys(enemys, state) {\r\n\t\tif (enemys !== null) {\r\n\t\t\tenemys.forEach((val) => {\r\n\t\t\t\tstate.setEnemy(val);\r\n\t\t\t});\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t_getStartPiointWatch(players, state) {\r\n\t\tlet watcher = players.filter(player => {\r\n\t\t\treturn player.watcher;\r\n\t\t});\r\n\r\n\t\tif (watcher.length !== 1) {\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\twatcher = watcher[0];\r\n\t\t}\r\n\r\n\t\tconst size = World.getSize(state);\r\n\r\n\t\tlet x = watcher.coor.x;\r\n\t\tlet y = watcher.coor.y;\r\n\t\tlet startPointWatch = {};\r\n\r\n\t\tstartPointWatch.x = findX(x, size);\r\n\t\tstartPointWatch.y = findY(y, size);\r\n\r\n\t\treturn startPointWatch;\r\n\r\n\t\tfunction findX (x, size) {\r\n\t\t\tlet newX = 0;\r\n\r\n\t\t\tif (x < Math.floor(size.heightBlocks / 2)) {\r\n\t\t\t\tnewX = 0;\r\n\t\t\t} else if (x >= (GLOBAL_SETTING.numBlocks.height - Math.floor(size.heightBlocks / 2))) {\r\n\t\t\t\tnewX = GLOBAL_SETTING.numBlocks.height - Math.floor(size.heightBlocks / 2);\r\n\t\t\t} else {\r\n\t\t\t\tnewX = x - Math.floor(size.heightBlocks / 2) + 1;\r\n\t\t\t}\r\n\r\n\t\t\treturn newX;\r\n\t\t}\r\n\r\n\t\tfunction findY (y, size) {\r\n\t\t\tlet newY = 0;\r\n\r\n\t\t\tif (y < Math.floor(size.widthBlocks / 2)) {\r\n\t\t\t\tnewY = 0;\r\n\t\t\t} else if (y >= (GLOBAL_SETTING.numBlocks.width - Math.floor(size.widthBlocks / 2))) {\r\n\t\t\t\tnewY = GLOBAL_SETTING.numBlocks.width - Math.floor(size.widthBlocks / 2);\r\n\t\t\t} else {\r\n\t\t\t\tnewY = y - Math.floor(size.widthBlocks / 2) + 1;\r\n\t\t\t}\r\n\r\n\t\t\treturn newY;\r\n\t\t}\r\n\t}\r\n\r\n\tgetState() {\r\n\t\treturn this.state;\r\n\t}\r\n\r\n\tasync tactOfGame(onlyRender = false) {\r\n\t\tthis.world.renderWorld();\r\n\r\n\t\tif (!onlyRender) {\r\n\t\t\tthis.state._creature.forEach((item) => {\r\n\t\t\t\tif (item.watcher !== true) {\r\n\t\t\t\t\tmoveEnemy(item);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t\tasync function moveEnemy(item) {\r\n\t\t\tawait item.movePerformance('rand');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n}","'use strict';\r\n\r\nmodule.exports = class StorCustomEvents {\r\n\tconstructor() {\r\n\t\tthis._eventBias = new CustomEvent('bias', {\r\n\t\t\tdetail: {\r\n\t\t\t\tdirection: null\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tgetEventBias() {\r\n\t\treturn this._eventBias;\r\n\t}\r\n}","'use strict';\r\n\r\nmodule.exports = class Block {\r\n\tconstructor() {\r\n\t\tthis.nesting = false;\r\n\t\tthis.isCreature = false;\r\n\t}\r\n}","'use strict';\r\n\r\nconst Block = require('./block.js');\r\n\r\nmodule.exports = class BorderBlock extends Block {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.type = 'border';\r\n\t\tthis.idBlock = 2;\r\n\t\tthis.patency = false;\r\n\t\tthis.classNameCSS = 'border';\r\n\t}\r\n}","'use strict';\r\nconst BorderBlock = require('./borderblock.js');\r\nconst DirtBlock = require('./dirtblock.js');\r\n\r\nmodule.exports = class BlockController {\r\n\tconstructor (){}\r\n\r\n\tstatic getBlockObject(id) {\r\n\t\tswitch(id) {\r\n\t\t\tcase 1:\r\n\t\t\t\treturn new DirtBlock();\r\n\t\t\tcase 2:\r\n\t\t\t\treturn new BorderBlock();\r\n\t\t}\r\n\t}\r\n}","'use strict';\r\n\r\nconst Block = require('./block.js');\r\n\r\nmodule.exports = class DirtBlock extends Block {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.type = 'dirt';\r\n\t\tthis.idBlock = 1;\r\n\t\tthis.patency = true;\r\n\t\tthis.classNameCSS = 'dirt';\r\n\t}\r\n}","const ControllerBlock = require('./blocks/controllerBlock.js');\r\n\r\nmodule.exports = class Place {\r\n\tconstructor (config) {\r\n\t\tconst N = config.height;\r\n\t\tconst M = config.width;\r\n\t\tthis.height = N;\r\n\t\tthis.width = M;\r\n\r\n\t\tfor (let i = 0; i < N; i++) {\r\n\t\t\tthis[i] = [];\r\n\t\t\tfor (let j = 0; j < M; j++) {\r\n\t\t\t\tif (i === 0 || i + 1 === N || j === 0 || j + 1 === M){\r\n\t\t\t\t\tthis[i][j] = ControllerBlock.getBlockObject(2);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis[i][j] = ControllerBlock.getBlockObject(1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\taddRoom () {\r\n\t\tconst N = this.height;\r\n\t\tconst M = this.width;\r\n\r\n\t\tfor (let i = 0; i < N; i+= 8) {\r\n\t\t\tfor (let j = 0; j < M; j++) {\r\n\t\t\t\tconst randDigit = Math.floor(Math.random() * 400);\r\n\t\t\t\tif (randDigit > 9 && randDigit < 25) {\r\n\t\t\t\t\tfor (let k = j; k < j+randDigit && k < M; k++) {\r\n\t\t\t\t\t\tif (k === j) {\r\n\t\t\t\t\t\t\tfor (let n = i; n < i+randDigit+1 && n < N; n++) {\r\n\t\t\t\t\t\t\t\tthis[n][k] = ControllerBlock.getBlockObject(2);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis[i][k] = ControllerBlock.getBlockObject(2);\r\n\t\t\t\t\t\t\tthis[(i+randDigit >= N ? i : i+randDigit)][k] = ControllerBlock.getBlockObject(2);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tj+= 8;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetCell(x, y) {\r\n\t\treturn this[x][y];\r\n\t}\r\n\r\n\tsetCell(x, y, val) {\r\n\t\tif (typeof val === 'object') {\r\n\t\t\tthis[x][y] = val;\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tgetAllPlace() {\r\n\t\treturn this;\r\n\t}\r\n\r\n\tcreateNewBlock(id = 0) {\r\n\t\treturn ControllerBlock.getBlockObject(id);\r\n\t}\r\n}","'use strict';\r\n\r\nmodule.exports = class stackTempClassName {\r\n\tconstructor() {\r\n\t\tthis._stack = [];\r\n\t}\r\n\r\n\taddTemp() {\r\n\r\n\t}\r\n\r\n\tremoveTemp() {\r\n\r\n\t}\r\n}","'use strict';\r\n\r\nconst Place = require('./inerState/place/place.js');\r\nconst StackTempClassName = require('./inerState/stackTemp/stackTempClassName.js');\r\nconst StorCustomEvents = require('./inerState/events/StorCustomEvents.js')\r\n\r\nconst Player = require('../../inerObjects/player.js');\r\nconst Enemy = require('../../inerObjects/enemy.js');\r\nconst Weapon = require('../../inerObjects/weapon.js');\r\n\r\nconst Coor = require('../../structOfDate/coordinate.js');\r\n\r\nmodule.exports = class State {\r\n\tconstructor (config) {\r\n\t\tthis._numInerBlock = 0;\r\n\r\n\t\tthis._place = new Place(config);\r\n\t\tthis._place.addRoom();\r\n\r\n\t\tthis._creature = [];\r\n\t\tthis._weapons = {};\r\n\r\n\t\tthis._pointWatch = {};\r\n\t\tthis._startPointWatch = new Coor(0, 0);\r\n\t\tthis._bias = null;\r\n\r\n\t\tthis._worldDiv = null;\r\n\t\tthis._worldObject = null;\r\n\r\n\t\tthis._sizeWorld = {\r\n\t\t\tfirstFindSize: true,\r\n\t\t\tsizeG: null\r\n\t\t};\r\n\r\n\t\tthis._stackTempClassName = new StackTempClassName();\r\n\r\n\t\tthis._events = new StorCustomEvents();\r\n\t}\r\n\r\n\tdeleteWeapon(id = 0) {\r\n\t\tlet weapon = this._weapons[id];\r\n\t\tthis._place[weapon.coor.x][weapon.coor.y] = this._place.createNewBlock(weapon.idBackBlock);\r\n\t\tdelete this._weapons[id];\r\n\t}\r\n\r\n\tdeleteCreature(id = 0) {\r\n\t\tlet creature = this._creature[id];\r\n\t\tthis._place[creature.coor.x][creature.coor.y] = this._place.createNewBlock(creature.idBackBlock);\r\n\t\tdelete this._creature[id];\r\n\t}\r\n\r\n\tgetEventBias() {\r\n\t\treturn this._events.getEventBias();\r\n\t}\r\n\r\n\tgetSizeWorld() {\r\n\t\treturn this._sizeWorld;\r\n\t}\r\n\r\n\tsetFirstFindSize(sizeWorld) {\r\n\t\tthis._sizeWorld = sizeWorld;\r\n\t}\r\n\r\n\tsetCoorPlayer(coor, num = 0) {\r\n\t\tthis._creature[num] = {};\r\n\t\tthis._creature[num].coor = coor;\r\n\t\treturn true;\r\n\t}\r\n\r\n\tsetPlayer(val) {\r\n\t\tthis._creature[this._numInerBlock] = new Player(this._numInerBlock, this, val.watcher, val.coor, val.type);\r\n\t\tthis._place[val.coor.x][val.coor.y] = this._creature[this._numInerBlock++];\r\n\t\treturn true;\r\n\t}\r\n\r\n\tsetEnemy(val) {\r\n\t\tthis._creature[this._numInerBlock] = new Enemy(this._numInerBlock, this, val.coor, val.type);\r\n\t\tthis._place.setCell(val.coor.x, val.coor.y, this._creature[this._numInerBlock++]);\r\n\t\treturn true;\r\n\t}\r\n\r\n\tsetWeapon(val) {\r\n\t\tlet position = this._place[val.coor.x][val.coor.y];\r\n\r\n\r\n\t\tif (position.patency) {\r\n\t\t\tlet weapon = new Weapon(this._numInerBlock, this, val.owner, val.coor);\r\n\t\t\tthis._weapons[this._numInerBlock++] = weapon;\r\n\t\t\tthis._place[val.coor.x][val.coor.y] = weapon;\r\n\t\t\treturn weapon;\r\n\t\t} else if (position.health) {\r\n\t\t\tposition.getDemage(val.owner);\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tgetCreature(id = 0) {\r\n\t\tif (typeof +id !== 'number') {\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\treturn this._creature[id];\r\n\t\t}\r\n\t}\r\n\r\n\tgetAllCreature() {\r\n\t\treturn this._creature;\r\n\t}\r\n\r\n\tgetAllPlace() {\r\n\t\treturn this._place.getAllPlace();\r\n\t}\r\n\r\n\tgetCellPlace(coor) {\r\n\t\treturn this._place.getCell(coor.x, coor.y);\r\n\t}\r\n\r\n\tsetCellPlace(coor, val) {\r\n\t\tif (val.isCreature === true) {\r\n\t\t\tval.idBackBlock = this._place.getCell(coor.x, coor.y).idBlock;\r\n\t\t\tval.classNameBackBlock = this._place.getCell(coor.x, coor.y).classNameCSS;\r\n\t\t}\r\n\r\n\t\tthis._place.setCell(coor.x, coor.y, val);\r\n\t\treturn true;\r\n\t}\r\n\r\n\tchangeCoorPlayer(coor, id = 0) {\r\n\t\tthis._creature[id].coor.x = coor.x;\r\n\t\tthis._creature[id].coor.y = coor.y;\r\n\t\treturn true;\r\n\t}\r\n\r\n\tchangeCoorWeapon(coor, id = 0) {\r\n\t\tthis._weapons[id].coor.x = coor.x;\r\n\t\tthis._weapons[id].coor.y = coor.y;\r\n\t\treturn true;\r\n\t}\r\n\r\n\tsetBias(direction) {\r\n\t\tthis._bias = direction;\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetBias(remove) {\r\n\t\tif (this._bias !== undefined) {\r\n\t\t\tlet OldValue = this._bias;\r\n\t\t\tif (remove === true) {\r\n\t\t\t\tthis._bias = null;\r\n\t\t\t}\r\n\t\t\treturn OldValue;\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tsetPointWatch(coor, watcher) {\r\n\t\tthis._pointWatch.x = coor.x;\r\n\t\tthis._pointWatch.y = coor.y;\r\n\t\tthis._pointWatch.watcher = watcher;\r\n\t\treturn true;\r\n\t}\r\n\r\n\tchangePointWatch(bias) {\r\n\t\tswitch(bias) {\r\n\t\t\tcase 'right':\r\n\t\t\t\tthis._pointWatch.y++;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'left':\r\n\t\t\t\tthis._pointWatch.y--;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'up':\r\n\t\t\t\tthis._pointWatch.x--;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'down':\r\n\t\t\t\tthis._pointWatch.x++;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetPiointWatch() {\r\n\t\treturn this._pointWatch;\r\n\t}\r\n\r\n\tsetStartPointWatch(coor) {\r\n\t\tthis._startPointWatch.x = coor.x;\r\n\t\tthis._startPointWatch.y = coor.y;\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetStartPiointWatch() {\r\n\t\treturn this._startPointWatch;\r\n\t}\r\n\r\n\tchangeStartPointWatch(bias) {\r\n\t\tswitch(bias) {\r\n\t\t\tcase 'right':\r\n\t\t\t\tthis._startPointWatch.y++;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'left':\r\n\t\t\t\tthis._startPointWatch.y--;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'up':\r\n\t\t\t\tthis._startPointWatch.x--;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'down':\r\n\t\t\t\tthis._startPointWatch.x++;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tsetWorldDiv(worldDiv) {\r\n\t\tthis._worldDiv = worldDiv;\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetWorldDiv() {\r\n\t\treturn this._worldDiv;\r\n\t}\r\n\r\n\tsetWorldObject(obj) {\r\n\t\tthis._worldObject = obj;\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetWorldObject() {\r\n\t\treturn this._worldObject;\r\n\t}\r\n\r\n\tgetWatcher() {\r\n\t\tif (this._pointWatch.watcher) {\r\n\t\t\treturn this._pointWatch.watcher;\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n}","'use strict';\r\n\r\nconst GLOBAL_SETTING = new (require('../setting/globalSetting.js'))();\r\n\r\nconst Coor = require('../structOfDate/coordinate.js');\r\n\r\nmodule.exports = class World {\r\n\tconstructor(state) {\r\n\t\tthis.state = state;\r\n\t\tthis.size = World.getSize(state);\r\n\r\n\t\tthis.eventBias = state.getEventBias();\r\n\t}\r\n\r\n\tstatic getSize(state) {\r\n\t\tlet firstFindSize = state.getSizeWorld().firstFindSize;\r\n\r\n\t\tif (firstFindSize === true){\r\n\r\n\t\t\tconst widthBlocks = Math.floor(window.innerWidth / GLOBAL_SETTING.sizeBlock.width);\r\n\t\t\tconst heightBlocks = Math.floor(window.innerHeight / GLOBAL_SETTING.sizeBlock.height);\r\n\r\n\t\t\tlet sizeG = {\r\n\t\t\t\twidthBlocks: (widthBlocks < GLOBAL_SETTING.numBlocks.width ? widthBlocks : GLOBAL_SETTING.numBlocks.width),\r\n\t\t\t\theightBlocks: (heightBlocks < GLOBAL_SETTING.numBlocks.height ? heightBlocks : GLOBAL_SETTING.numBlocks.height)\r\n\t\t\t};\r\n\r\n\t\t\tstate.setFirstFindSize({\r\n\t\t\t\tfirstFindSize: true,\r\n\t\t\t\tsizeG: sizeG\r\n\t\t\t});\r\n\r\n\t\t\treturn sizeG;\r\n\t\t} else {\r\n\t\t\treturn state.getSizeWorld().sizeG;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic makeAroayWihtEnemy(num, state) {\r\n\t\tconst size = World.getSize(state);\r\n\r\n\t\tlet creatures = [];\r\n\t\tfor (let i = 0; i < num; i++) {\r\n\t\t\tlet newCreature = {};\r\n\t\t\tnewCreature.coor = new Coor();\r\n\t\t\tnewCreature.type = 'slime';\r\n\t\t\tnewCreature.coor.x = Math.floor(Math.random() * (GLOBAL_SETTING.numBlocks.height - 2)) + 1;\r\n\t\t\tnewCreature.coor.y = Math.floor(Math.random() * (GLOBAL_SETTING.numBlocks.width - 2)) + 1;\r\n\t\t\tcreatures[i] = newCreature;\r\n\t\t}\r\n\t\treturn creatures;\r\n\t}\r\n\r\n\trenderWorld(startRender) {\r\n\t\tconst state = this.state;\r\n\t\tconst size = this.size;\r\n\t\tconst bias = state.getBias(true);\r\n\t\tconst eventBias = this.eventBias;\r\n\r\n\t\tif (bias === null && startRender === true) {\r\n\t\t\tlet world = getEmptyWorld();\r\n\r\n\t\t\trendersBlocks(world, state, size);\r\n\t\t\tdeliteOldWorld();\r\n\t\t\tpushNewWorld(world);\r\n\r\n\t\t\treturn world;\r\n\t\t} else if (canIBias(size, state, bias) === true && bias !== null) {\r\n\r\n\t\t\tdespetchBiasEvent(bias, state);\r\n\r\n\t\t\tbiasRender(this, bias);\r\n\t\t\tstate.changeStartPointWatch(bias);\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t\tfunction canIBias(size, state, bias) {\r\n\t\t\tconst startPointWatch = state.getStartPiointWatch();\r\n\t\t\tconst pointWotch = state.getPiointWatch();\r\n\r\n\t\t\tif (\r\n\t\t\t(((startPointWatch.x === 0\r\n\t\t\t\t\t||\r\n\t\t\tstartPointWatch.x === GLOBAL_SETTING.numBlocks.height - size.heightBlocks)\r\n\t\t\t\t&&\r\n\t\t\t(pointWotch.x < Math.floor(size.heightBlocks / 2)\r\n\t\t\t\t\t||\r\n\t\t\tpointWotch.x >= (GLOBAL_SETTING.numBlocks.height - Math.floor(size.heightBlocks / 2)))\r\n\t\t\t\t&&\r\n\t\t\t(bias === 'up'\r\n\t\t\t\t\t||\r\n\t\t\tbias === 'down'))\r\n\t\t\t||\r\n\t\t\t((startPointWatch.y === 0\r\n\t\t\t\t\t||\r\n\t\t\tstartPointWatch.y === GLOBAL_SETTING.numBlocks.width - size.widthBlocks)\r\n\t\t\t\t&&\r\n\t\t\t(pointWotch.y < Math.floor(size.widthBlocks / 2)\r\n\t\t\t\t\t||\r\n\t\t\tpointWotch.y >= (GLOBAL_SETTING.numBlocks.width - Math.floor(size.widthBlocks / 2)))\r\n\t\t\t\t&&\r\n\t\t\t(bias === 'left'\r\n\t\t\t\t\t||\r\n\t\t\tbias === 'right')))\r\n\t\t\t){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tfunction getEmptyWorld() {\r\n\t\t\tlet world = document.createElement('div');\r\n\t\t\tworld.className = 'world';\r\n\t\t\treturn world;\r\n\t\t}\r\n\r\n\t\tfunction deliteOldWorld() {\r\n\t\t\tlet world = state.getWorldDiv();\r\n\t\t\tif (world !== null) {\r\n\t\t\t\tworld.remove();\r\n\t\t\t\tstate.setWorldDiv = null;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tfunction pushNewWorld(world) {\r\n\t\t\tdocument.querySelector('.wrapper').appendChild(world);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tfunction rendersBlocks(world, state, size) {\r\n\t\t\tconst x = state.getStartPiointWatch().x;\r\n\t\t\tconst y = state.getStartPiointWatch().y;\r\n\t\t\tconst place = state.getAllPlace();\r\n\r\n\t\t\tfor (let i = x; i < x + size.heightBlocks; i++) {\r\n\t\t\t\tlet row = document.createElement('div');\r\n\t\t\t\trow.className = 'row';\r\n\t\t\t\tfor (let j = y; j < y + size.widthBlocks; j++) {\r\n\t\t\t\t\tlet block = getBlock(place[i][j], {newX:i,newY:j});\r\n\t\t\t\t\trow.appendChild(block);\r\n\t\t\t\t}\r\n\t\t\t\tworld.appendChild(row);\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tfunction biasRender(world, bias) {\r\n\t\t\tconst state = world.state;\r\n\t\t\tconst size = world.size;\r\n\t\t\tconst place = state.getAllPlace();\r\n\t\t\tconst oldWorld = state.getWorldDiv();\r\n\t\t\tconst startPointWatch = state.getStartPiointWatch();\r\n\r\n\t\t\tif (bias === 'right' || bias === 'left') {\r\n\t\t\t\tleftRightBias();\r\n\t\t\t} else if (bias === 'up' || bias === 'down') {\r\n\t\t\t\tupDownBias();\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tstate.changePointWatch(bias);\r\n\t\t\treturn true;\r\n\r\n\t\t\tfunction leftRightBias() {\r\n\t\t\t\tconst x = state.getStartPiointWatch().x;\r\n\r\n\t\t\t\tfor (let i = x; i < x + size.heightBlocks; i++) {\r\n\r\n\t\t\t\t\tlet y = 0;\r\n\t\t\t\t\tlet newY = 0;\r\n\r\n\t\t\t\t\tif (bias === 'right') {\r\n\t\t\t\t\t\ty = state.getStartPiointWatch().y + size.widthBlocks;\r\n\t\t\t\t\t\tnewY = y - size.widthBlocks;\r\n\t\t\t\t\t} else if (bias === 'left') {\r\n\t\t\t\t\t\ty = state.getStartPiointWatch().y - 1;\r\n\t\t\t\t\t\tnewY = y + size.widthBlocks;\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif (place[i][newY].isCreature === true) {\r\n\t\t\t\t\t\tvisableHideCreature(place[i][newY]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet block = null;\r\n\t\t\t\t\tlet line = oldWorld.children[i-x];\r\n\t\t\t\t\tlet idBlockForRemove = (bias === 'right' ? 0 : line.children.length - 1);\r\n\r\n\t\t\t\t\tblock = getBlock(place[i][y], {newX:i,newY:y}, true, line.children[idBlockForRemove]);\r\n\r\n\t\t\t\t\tif (bias === 'right') {\r\n\t\t\t\t\t\tline.appendChild(block);\r\n\t\t\t\t\t} else if (bias === 'left') {\r\n\t\t\t\t\t\tline.insertBefore(block, oldWorld.children[i-x].children[0]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tfunction upDownBias() {\r\n\t\t\t\tconst y = state.getStartPiointWatch().y;\r\n\r\n\t\t\t\tlet row = null;\r\n\r\n\t\t\t\tif (bias === 'up') {\r\n\t\t\t\t\trow = oldWorld.children[oldWorld.children.length-1];\r\n\t\t\t\t} else if (bias === 'down') {\r\n\t\t\t\t\trow = oldWorld.children[0];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let i = y; i < y + size.widthBlocks; i++) {\r\n\t\t\t\t\tlet x = 0;\r\n\t\t\t\t\tlet newX = 0;\r\n\r\n\t\t\t\t\tif (bias === 'up') {\r\n\t\t\t\t\t\tx = state.getStartPiointWatch().x - 1;\r\n\t\t\t\t\t\tnewX = x + size.heightBlocks;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tx = state.getStartPiointWatch().x + size.heightBlocks;\r\n\t\t\t\t\t\tnewX = x - size.heightBlocks;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet block = getBlock(place[x][i], {newX:x,newY:i}, true, row.children[i-y]);\r\n\r\n\t\t\t\t\tif (place[newX][i].isCreature === true) {\r\n\t\t\t\t\t\tvisableHideCreature(place[newX][i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (bias === 'up') {\r\n\t\t\t\t\toldWorld.insertBefore(row, oldWorld.children[0]);\r\n\t\t\t\t} else if (bias === 'down') {\r\n\t\t\t\t\toldWorld.appendChild(row);\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction getBlock(blockObject, coor, bias, lastBlock = null) {\r\n\t\t\tlet block = null;\r\n\r\n\t\t\tif (lastBlock === null) {\r\n\t\t\t\tblock = document.createElement('div');\r\n\t\t\t} else {\r\n\t\t\t\tblock = lastBlock;\r\n\r\n\t\t\t\tif (block.children[0]) {\r\n\t\t\t\t\tblock.children[0].remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (blockObject.nesting === true) {\r\n\t\t\t\tblock.className = 'standartPlace ' + blockObject.classNameBackBlock;\r\n\r\n\t\t\t\tif (blockObject.isCreature === true) {\r\n\t\t\t\t\tgetCreature(block, blockObject, coor);\r\n\t\t\t\t\tblockObject.DOMObject = block;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tchangeVisableCreature();\r\n\t\t\t} else {\r\n\t\t\t\tblock.className = 'standartPlace ' + blockObject.classNameCSS;\r\n\t\t\t}\r\n\r\n\t\t\treturn block;\r\n\r\n\t\t\tfunction getCreature(block, creature, coor) {\r\n\t\t\t\tlet div = document.createElement('div');\r\n\t\t\t\tdiv.className = creature.classNameCSS;\r\n\t\t\t\tblock.appendChild(div);\r\n\r\n\t\t\t\tif (bias === true) {\r\n\t\t\t\t\tcreature.visable.was = false;\r\n\t\t\t\t\tcreature.visable.now = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tfunction changeVisableCreature() {\r\n\t\t\t\tblockObject.visable = {\r\n\t\t\t\t\twas: blockObject.visable.now,\r\n\t\t\t\t\tnow: true\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction visableHideCreature(creature) {\r\n\t\t\tcreature.visable.was = true;\r\n\t\t\tcreature.visable.now = false;\r\n\t\t}\r\n\r\n\t\tfunction despetchBiasEvent(bias, state) {\r\n\t\t\teventBias.detail.direction = bias;\r\n\t\t\tdocument.dispatchEvent(eventBias);\r\n\t\t\teventBias.detail.direction = null;\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n}","'use strict';\r\n\r\nfunction startGame() {\r\n\tconst GLOBAL_SETTING = new (require('./setting/globalSetting.js'))();\r\n\tconst ControllerGame = require('./globalClass/game.js');\r\n\r\n\tconst game = new ControllerGame([{\r\n\t\tcoor: {\r\n\t\t\tx: 1,\r\n\t\t\ty: 1\r\n\t\t},\r\n\t\ttype: 'mage',\r\n\t\twatcher: true\r\n\t}]);\r\n\r\n\tconst state = game.getState();\r\n\tconst player = state.getCreature(0);\r\n\r\n\tlet timer = false;\r\n\r\n\tdocument.onkeydown = function (e) {\r\n\t\tif (timer) {\r\n\t\t\treturn 0;\r\n\t\t} else {\r\n\t\t\ttimer = true;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\ttimer = false;\r\n\t\t\t}, GLOBAL_SETTING.timeOfTactPlayer);\r\n\t\t}\r\n\r\n\t\tif (e.keyCode === 68) {\r\n\t\t\tplayer.movePerformance('right');\r\n\t\t} else if (e.keyCode === 83) {\r\n\t\t\tplayer.movePerformance('down');\r\n\t\t} else if (e.keyCode === 87) {\r\n\t\t\tplayer.movePerformance('up');\r\n\t\t} else if (e.keyCode === 65) {\r\n\t\t\tplayer.movePerformance('left');\r\n\t\t} else if (e.keyCode === 39) {\r\n\t\t\tplayer.doAttack('right');\r\n\t\t} else if (e.keyCode === 40) {\r\n\t\t\tplayer.doAttack('down');\r\n\t\t} else if (e.keyCode === 38) {\r\n\t\t\tplayer.doAttack('up');\r\n\t\t} else if (e.keyCode === 37) {\r\n\t\t\tplayer.doAttack('left');\r\n\t\t}\r\n\t\tgame.tactOfGame(true);\r\n\t}\r\n\r\n\tsetInterval(() => {\r\n\t\tgame.tactOfGame();\r\n\t}, GLOBAL_SETTING.timeOfTactOther);\r\n\r\n\tconsole.log(state);\r\n}\r\n\r\n\r\nstartGame();","'use strict';\r\n\r\nconst InnerObject = require('./innerObject.js');\r\nconst Weapon = require('./weapon.js');\r\n\r\nconst GLOBAL_SETTING = new (require('../setting/globalSetting.js'))();\r\n\r\nconst Coor = require('../structOfDate/coordinate.js');\r\nconst ExCoor = require('../structOfDate/ExCoordinate.js');\r\n\r\nconst ControllerBlock = require('../globalClass/state/inerState/place/blocks/controllerBlock.js');\r\n\r\nconst World = require('../globalClass/world.js');\r\n\r\nmodule.exports = class Creature extends InnerObject {\r\n\tconstructor (id, state, coor) {\r\n\t\tsuper(id, state, coor);\r\n\t\tthis.isCreature = true;\r\n\r\n\t\tthis.health = 100;\r\n\t\tthis.attackDamage = 20;\r\n\t\tthis.attackRange = 10;\r\n\t\tthis.pursuitRange = 50;\r\n\r\n\t\tstate.setCoorPlayer(coor, id);\r\n\t}\r\n\r\n\tmovePerformance(direction) {\r\n\t\tif (direction === 'rand') {\r\n\t\t\tconst state = this.state;\r\n\t\t\tconst watcher = state.getWatcher();\r\n\t\t\tconst watcherX = watcher.coor.x;\r\n\t\t\tconst watcherY = watcher.coor.y;\r\n\t\t\tconst x = this.coor.x;\r\n\t\t\tconst y = this.coor.y;\r\n\t\t\tconst range = this.pursuitRange;\r\n\t\t\tif (\r\n\t\t\t\twatcherX > x - range\r\n\t\t\t&&\r\n\t\t\t\twatcherX < x + range\r\n\t\t\t&&\r\n\t\t\t\twatcherY < y + range\r\n\t\t\t&&\r\n\t\t\t\twatcherY > y -range\r\n\t\t\t){\r\n\t\t\t\tthis._approximatingToWatcher();\r\n\t\t\t} else {\r\n\t\t\t\tthis._randMove();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis._move(direction);\r\n\t\t}\r\n\t}\r\n\r\n\tdoAttack(direction) {\r\n\t\tconst creature = this;\r\n\t\tconst state = this.state;\r\n\t\tconst world = state.getWorldObject();\r\n\r\n\t\tlet coor = new ExCoor(this.coor.x, this.coor.y, this.coor.x, this.coor.y);\r\n\r\n\t\trenderWeapon(direction, coor);\r\n\r\n\t\tasync function renderWeapon(direction, coor) {\r\n\t\t\tlet nextBlock = true;\r\n\t\t\tlet weapon = null;\r\n\r\n\t\t\tcoor = defineCoor(direction, coor);\r\n\r\n\t\t\tweapon = state.setWeapon({\r\n\t\t\t\tcoor: {\r\n\t\t\t\t\tx: coor.newX,\r\n\t\t\t\t\ty: coor.newY\r\n\t\t\t\t},\r\n\t\t\t\towner: creature\r\n\t\t\t});\r\n\r\n\t\t\tif (weapon == null) {\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tweapon.coor.x = coor.x;\r\n\t\t\t\tweapon.coor.y = coor.y;\r\n\r\n\t\t\t\tlet range = creature.attackRange;\r\n\r\n\t\t\t\tdo {\r\n\t\t\t\t\tnextBlock = await biasWeapon(weapon, direction);\r\n\t\t\t\t} while ((nextBlock.patency || nextBlock === true) && range--);\r\n\r\n\t\t\t\tif (creature.state.getCellPlace(creature.coor) !== creature) {\r\n\t\t\t\t\tcreature.state.setCellPlace(creature.coor, creature);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (nextBlock.isCreature) {\r\n\t\t\t\t\tnextBlock.getDemage(creature);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tweapon.die();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tasync function biasWeapon(weapon, direction) {\r\n\t\t\tawait smallTime();\r\n\t\t\treturn weapon.movePerformance(direction);\r\n\t\t}\r\n\r\n\t\tfunction smallTime() {\r\n\t\t\treturn new Promise(resolve => {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tresolve('resolved');\r\n\t\t\t\t}, 20);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction defineCoor(direction, coor) {\r\n\t\t\tcoor.x = coor.newX;\r\n\t\t\tcoor.y = coor.newY;\r\n\r\n\t\t\tswitch(direction) {\r\n\t\t\t\tcase 'left':\r\n\t\t\t\t\tcoor.newY--;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'right':\r\n\t\t\t\t\tcoor.newY++\t;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'up':\r\n\t\t\t\t\tcoor.newX--;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'down':\r\n\t\t\t\t\tcoor.newX++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\treturn coor;\r\n\t\t}\r\n\t}\r\n\r\n\t_randMove() {\r\n\t\tlet digit = Math.floor(Math.random() * 4) + 1;\r\n\t\tlet direction = '';\r\n\t\tswitch(digit) {\r\n\t\t\tcase 1:\r\n\t\t\t\tdirection = 'left';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tdirection = 'right';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tdirection = 'up';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tdirection = 'down';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tthis._move(direction);\r\n\t\treturn true;\r\n\t}\r\n\r\n\t_approximatingToWatcher() {\r\n\t\tconst creature = this;\r\n\t\tconst range = creature.pursuitRange;\r\n\t\tconst side = (((range * 2) + 1) + 2); // (+1) - creature, (+2) - border\r\n\t\tconst state = creature.state;\r\n\t\tconst place = state.getAllPlace();\r\n\t\tconst startX = creature.coor.x - range;\r\n\t\tconst startY = creature.coor.y - range;\r\n\t\tconst watcher = state.getWatcher();\r\n\r\n\t\tlet localPlace = getLocalPlace();\r\n\t\tlet direction = wave(localPlace);\r\n\r\n\t\tif (direction === false) {\r\n\t\t\tcreature._randMove();\r\n\t\t} else {\r\n\t\t\tcreature._move(direction);\r\n\t\t}\r\n\r\n\t\tfunction getLocalPlace() {\r\n\t\t\tlet localPlace = [];\r\n\r\n\t\t\tlet cell = null;\r\n\r\n\t\t\tfor (let i = 0; i < side; i++) {\r\n\t\t\t\tlocalPlace[i] = [];\r\n\r\n\t\t\t\tfor (let j = 0; j < side; j++) {\r\n\t\t\t\t\tif (i === 0 || i === side - 1 || j === 0 || j === side - 1) {\r\n\t\t\t\t\t\tlocalPlace[i][j] = -1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (place[startX + i] !== undefined && place[startX + i][startY + j] !== undefined){\r\n\t\t\t\t\t\t\tcell = place[startX + i][startY + j];\r\n\t\t\t\t\t\t\tif (cell === creature) {\r\n\t\t\t\t\t\t\t\tlocalPlace[i][j] = 0;\r\n\t\t\t\t\t\t\t\tlocalPlace.own = {\r\n\t\t\t\t\t\t\t\t\ti: i,\r\n\t\t\t\t\t\t\t\t\tj: j\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (cell === watcher) {\r\n\t\t\t\t\t\t\t\tlocalPlace[i][j] = -2;\r\n\t\t\t\t\t\t\t} else if (cell.patency === true) {\r\n\t\t\t\t\t\t\t\tlocalPlace[i][j] = Infinity;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tlocalPlace[i][j] = -1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlocalPlace[i][j] = -1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn localPlace;\r\n\t\t}\r\n\r\n\t\tfunction wave(localPlace) {\r\n\t\t\tconst ownX = localPlace.own.i;\r\n\t\t\tconst ownY = localPlace.own.j;\r\n\r\n\t\t\tlet cur = 0;\r\n\t\t\tlet wayExist = false;\r\n\t\t\tlet findWatcher = false;\r\n\t\t\tlet coorWatcher = new Coor();\r\n\t\t\tlet locCoor = new Coor();\r\n\r\n\t\t\tdo {\r\n\t\t\t\twayExist = false;\r\n\r\n\t\t\t\tfor (let i = 0; i < side; i++) {\r\n\t\t\t\t\tif (findWatcher) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (let j = 0; j < side; j++) {\r\n\t\t\t\t\t\tif (localPlace[i][j] === cur) {\r\n\t\t\t\t\t\t\tif (localPlace[i + 1][j] > cur + 1) {\r\n\t\t\t\t\t\t\t\tlocalPlace[i + 1][j] = cur + 1;\r\n\t\t\t\t\t\t\t\twayExist = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (localPlace[i - 1][j] > cur + 1) {\r\n\t\t\t\t\t\t\t\tlocalPlace[i - 1][j] = cur + 1;\r\n\t\t\t\t\t\t\t\twayExist = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (localPlace[i][j + 1] > cur + 1) {\r\n\t\t\t\t\t\t\t\tlocalPlace[i][j + 1] = cur + 1;\r\n\t\t\t\t\t\t\t\twayExist = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (localPlace[i][j - 1] > cur + 1) {\r\n\t\t\t\t\t\t\t\tlocalPlace[i][j - 1] = cur + 1;\r\n\t\t\t\t\t\t\t\twayExist = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (localPlace[locCoor.x = i - 1][locCoor.y = j] === -2\r\n\t\t\t\t\t\t\t||  localPlace[locCoor.x = i + 1][locCoor.y = j] === -2\r\n\t\t\t\t\t\t\t||  localPlace[locCoor.x = i][locCoor.y = j + 1] === -2\r\n\t\t\t\t\t\t\t||  localPlace[locCoor.x = i][locCoor.y = j - 1] === -2\r\n\t\t\t\t\t\t\t){\r\n\t\t\t\t\t\t\t\tfindWatcher = true;\r\n\t\t\t\t\t\t\t\tcoorWatcher.x = locCoor.x;\r\n\t\t\t\t\t\t\t\tcoorWatcher.y = locCoor.y;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcur++;\r\n\t\t\t} while (wayExist && !findWatcher);\r\n\r\n\t\t\tif (findWatcher) {\r\n\t\t\t\tfor (let i = cur; i >= 0; i--) {\r\n\t\t\t\t\tif (localPlace[coorWatcher.x + 1][coorWatcher.y] === i - 1) {\r\n\t\t\t\t\t\tcoorWatcher.x++;\r\n\t\t\t\t\t\tif (i === 1) {\r\n\t\t\t\t\t\t\treturn 'up';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (localPlace[coorWatcher.x - 1][coorWatcher.y] === i - 1) {\r\n\t\t\t\t\t\tcoorWatcher.x--;\r\n\t\t\t\t\t\tif (i === 1) {\r\n\t\t\t\t\t\t\treturn 'down';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (localPlace[coorWatcher.x][coorWatcher.y + 1] === i - 1) {\r\n\t\t\t\t\t\tcoorWatcher.y++;\r\n\t\t\t\t\t\tif (i === 1) {\r\n\t\t\t\t\t\t\treturn 'left';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (localPlace[coorWatcher.x][coorWatcher.y - 1] === i - 1) {\r\n\t\t\t\t\t\tcoorWatcher.y--;\r\n\t\t\t\t\t\tif (i === 1) {\r\n\t\t\t\t\t\t\treturn 'right';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetDemage(creature) {\r\n\t\tif (this.health > 0) {\r\n\t\t\tthis.health -= creature.attackDamage;\r\n\r\n\t\t\tif (this.health <= 0) {\r\n\t\t\t\tthis.die();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthrow \"zombie\";\r\n\t\t}\r\n\t}\r\n}","'use strict';\r\n\r\nconst Creature = require('./creature');\r\n\r\nmodule.exports = class Enemy extends Creature {\r\n\tconstructor (id, state, coor) {\r\n\t\tsuper(id, state, coor);\r\n\t\tthis.type = 'enemy';\r\n\t\tthis.classNameCSS = 'slimeEnemy';\r\n\t\tthis.watcher = false;\r\n\t}\r\n}","'use strict';\r\n\r\nconst GLOBAL_SETTING = new (require('../setting/globalSetting.js'))();\r\n\r\nconst Coor = require('../structOfDate/coordinate.js');\r\nconst ExCoor = require('../structOfDate/ExCoordinate.js');\r\n\r\nconst ControllerBlock = require('../globalClass/state/inerState/place/blocks/controllerBlock.js');\r\n\r\nconst World = require('../globalClass/world.js');\r\n\r\nmodule.exports = class InnerObject {\r\n\tconstructor (id, state, coor) {\r\n\t\tthis.nesting = true;\r\n\t\tthis.patency = false;\r\n\t\tthis.state = state;\r\n\t\tthis.coor = coor;\r\n\t\tthis.id = id;\r\n\r\n\t\tthis.visable = {};\r\n\t\tthis.visable.was = false;\r\n\t\tthis.visable.now = false;\r\n\t\tthis.visable = this._identifyVisable({newX: coor.x, newY: coor.y}, state);\r\n\r\n\t\tthis.classNameCSS = '';\r\n\t\tthis.classNameBackBlock = 'dirt';\r\n\t\tthis.idBackBlock = 1;\r\n\t\tthis.DOMObject = null;\r\n\t}\r\n\r\n\tmovePerformance(direction) {\r\n\t\treturn this._move(direction);\r\n\t}\r\n\r\n\t_identifyVisable(coor, state) {\r\n\t\tconst visable = {};\r\n\t\tif (this.watcher === true) {\r\n\t\t\tvisable.now = true;\r\n\t\t\tvisable.was = true;\r\n\t\t} else {\r\n\t\t\tconst startPointWatch = this.state.getStartPiointWatch();\r\n\t\t\tconst size = World.getSize(state);\r\n\t\t\tvisable.was = this.visable.now;\r\n\t\t\tif (coor.newX - startPointWatch.x < size.heightBlocks\r\n\t\t\t&&\r\n\t\t\t\tcoor.newY - startPointWatch.y < size.widthBlocks\r\n\t\t\t&&\r\n\t\t\t\tcoor.newX - startPointWatch.x >= 0\r\n\t\t\t&&\r\n\t\t\t\tcoor.newY - startPointWatch.y >= 0\r\n\t\t\t) {\r\n\t\t\t\tvisable.now = true;\r\n\t\t\t} else {\r\n\t\t\t\tvisable.now = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.type === 'weapon' && this.born) {\r\n\t\t\tthis.born = false;\r\n\t\t\tvisable.was = false;\r\n\t\t}\r\n\r\n\t\treturn visable;\r\n\t}\r\n\r\n\t_move(direction) {\r\n\t\tconst id = this.id;\r\n\t\tconst ownObject = this;\r\n\t\tconst state = this.state;\r\n\r\n\r\n\t\tlet x = this.coor.x;\r\n\t\tlet y = this.coor.y;\r\n\r\n\t\tlet curCoor = new ExCoor(x, y, x, y);\r\n\r\n\t\tlet newPosition = null;\r\n\r\n\t\tswitch(direction) {\r\n\t\t\tcase 'right':\r\n\t\t\t\tif (GLOBAL_SETTING.numBlocks.width <= curCoor.y+1) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurCoor.newY++;\r\n\t\t\t\t\tnewPosition = state.getCellPlace({x:curCoor.x, y:(curCoor.y+1)});\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'left':\r\n\t\t\t\tif (0 > curCoor.y - 1) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurCoor.newY--;\r\n\t\t\t\t\tnewPosition = state.getCellPlace({x:curCoor.x, y:(curCoor.y-1)});\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'up':\r\n\t\t\t\tif (0 > curCoor.x-1) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurCoor.newX--;\r\n\t\t\t\t\tnewPosition = state.getCellPlace({x:(curCoor.x-1), y:curCoor.y});\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'down':\r\n\t\t\t\tif (GLOBAL_SETTING.numBlocks.height <= curCoor.x+1) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurCoor.newX++;\r\n\t\t\t\t\tnewPosition = state.getCellPlace({x:(curCoor.x+1), y:curCoor.y});\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow 'empty direction on move creature: ' + this.id;\r\n\t\t}\r\n\r\n\t\tif (newPosition.patency || this.born) {\r\n\t\t\treturn moving(curCoor, this);\r\n\t\t} else {\r\n\t\t\treturn newPosition;\r\n\t\t}\r\n\r\n\t\tfunction moving(coor, creature) {\r\n\t\t\tif (creature.watcher === true) {\r\n\t\t\t\tmovingPointAndBais(coor, creature, direction);\r\n\t\t\t}\r\n\r\n\t\t\tconst state = creature.state;\r\n\r\n\t\t\tcreature.visable = creature._identifyVisable(coor, state);\r\n\t\t\tcreature._movingVisableSwapingIcon(coor, state);\r\n\t\t\tchangeCoordinate(creature, coor);\r\n\t\t\treturn true;\r\n\r\n\t\t\tfunction changeCoordinate(player, coor) {\r\n\t\t\t\tplayer.state.setCellPlace({\r\n\t\t\t\t\tx: player.coor.x,\r\n\t\t\t\t\ty: player.coor.y\r\n\t\t\t\t}, ControllerBlock.getBlockObject(player.idBackBlock));\r\n\r\n\t\t\t\tif (player.isCreature) {\r\n\t\t\t\t\tplayer.state.changeCoorPlayer({\r\n\t\t\t\t\t\tx: coor.newX,\r\n\t\t\t\t\t\ty: coor.newY\r\n\t\t\t\t\t}, id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tplayer.state.changeCoorWeapon({\r\n\t\t\t\t\t\tx: coor.newX,\r\n\t\t\t\t\t\ty: coor.newY\r\n\t\t\t\t\t}, id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tplayer.state.setCellPlace({\r\n\t\t\t\t\tx: coor.newX,\r\n\t\t\t\t\ty: coor.newY\r\n\t\t\t\t}, player);\r\n\r\n\t\t\t\tplayer.coor.x = coor.newX;\r\n\t\t\t\tplayer.coor.y = coor.newY;\r\n\t\t\t}\r\n\r\n\t\t\tfunction movingPointAndBais(coor, creature, direction) {\r\n\t\t\t\tcreature.state.setBias(direction);\r\n\t\t\t\tcreature.state.setPointWatch({x:coor.newX, y:coor.newY}, creature);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t_movingVisableSwapingIcon(coor, state) {\r\n\t\tconst startPointWatch = this.state.getStartPiointWatch();\r\n\t\tconst world = this.state.getWorldDiv();\r\n\t\tconst size = World.getSize(state);\r\n\r\n\t\tlet div = getBlockWithCreature(this);\r\n\r\n\t\tif (this.visable.was === true) {\r\n\t\t\tthis.DOMObject.children[0].remove();\r\n\t\t\tthis.DOMObject = null;\r\n\t\t}\r\n\r\n\t\tif (this.visable.now === true) {\r\n\t\t\tworld.children[coor.newX - startPointWatch.x].children[coor.newY - startPointWatch.y].appendChild(div);\r\n\t\t\tthis.DOMObject = div.parentNode;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t\tfunction getBlockWithCreature(creature) {\r\n\t\t\tlet div = document.createElement('div');\r\n\t\t\tdiv.className = creature.classNameCSS;\r\n\t\t\treturn div;\r\n\t\t}\r\n\t}\r\n\r\n\tdie() {\r\n\t\tif (this.DOMObject.children[0]) {\r\n\t\t\tthis.DOMObject.children[0].remove();\r\n\t\t}\r\n\t\tthis.state.deleteCreature(this.id);\r\n\t}\r\n}","'use strict';\r\n\r\nconst Creature = require('./creature');\r\n\r\nmodule.exports = class Player extends Creature {\r\n\tconstructor (id, state, watcher, coor, profession) {\r\n\t\tsuper(id, state, coor);\r\n\t\tthis.type = 'player';\r\n\r\n\t\tif (watcher === true){\r\n\t\t\tthis.watcher = true;\r\n\t\t\tstate.setPointWatch(coor, this);\r\n\t\t\tthis.visable = {\r\n\t\t\t\twas: true,\r\n\t\t\t\tnow: true\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tthis.watcher = false;\r\n\t\t}\r\n\r\n\t\tswitch(profession) {\r\n\t\t\tcase 'mage':\r\n\t\t\t\tthis.classNameCSS = 'magePlayer';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}","'use strict';\r\n\r\nconst InnerObject = require('./innerObject.js');\r\n\r\nconst GLOBAL_SETTING = new (require('../setting/globalSetting.js'))();\r\n\r\nconst Coor = require('../structOfDate/coordinate.js');\r\nconst ExCoor = require('../structOfDate/ExCoordinate.js');\r\n\r\nconst ControllerBlock = require('../globalClass/state/inerState/place/blocks/controllerBlock.js');\r\n\r\nconst World = require('../globalClass/world.js');\r\n\r\n\r\nmodule.exports = class Weapon extends InnerObject {\r\n\tconstructor (id, state, owner, coor) {\r\n\t\tsuper(id, state, coor);\r\n\t\tthis.isCreature = false;\r\n\t\tthis.owner = owner;\r\n\r\n\t\tthis.type = 'weapon';\r\n\t\tthis.born = true;\r\n\r\n\t\tthis.classNameCSS = 'weapon';\r\n\t}\r\n\r\n\tdie() {\r\n\t\tif (this.DOMObject.children[0]) {\r\n\t\t\tthis.DOMObject.children[0].remove();\r\n\t\t}\r\n\t\tthis.state.deleteWeapon(this.id);\r\n\t}\r\n}","'use strict';\r\n\r\nconst Size = require('../structOfDate/size.js');\r\n\r\nmodule.exports = class GLOBAL_SETTING {\r\n\tconstructor() {\r\n\t\tthis.sizeBlock = new Size(30, 30);\r\n\t\tthis.numBlocks = new Size(2 ** 10, 2 ** 10);\r\n\r\n\t\tthis.numEnemy = 2000;\r\n\r\n\t\tthis.timeOfTactPlayer = 50;\r\n\t\tthis.timeOfTactOther = 200;\r\n\t}\r\n}","'use strict';\r\n\r\nconst Coor = require('./coordinate.js');\r\n\r\nmodule.exports = class ExCoor extends Coor {\r\n\tconstructor (x = 0, y = 0, newX = 0, newY = 0) {\r\n\t\tsuper(x, y);\r\n\t\tthis.newX = newX;\r\n\t\tthis.newY = newY;\r\n\t}\r\n}","'use strict';\r\n\r\nmodule.exports = class Coor {\r\n\tconstructor(x = 0, y = 0) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n}","'use strict';\r\n\r\nmodule.exports = class Size {\r\n\tconstructor(width = 0, height = 0) {\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t}\r\n}"],"sourceRoot":""}